#!/usr/bin/env bash
# Copyright (c) 2011 Concurrent, Inc.

## NOTE Do not change these lines.  They are rewritten during installation.
if [ "$MT_PATH" = "" ]; then
MT_PATH=..
fi
## /NOTE

# If the above line is not set (ie. mt is not installed), set it
if [ "$MT_PATH" = ".." ]
then
  MT_PATH=`dirname $0`/..
  MT_PATH=`cd $MT_PATH && pwd`
fi

MODULES_ROOT=$MT_PATH/bin/functions
. $MT_PATH/bin/functions/_module.inc

module_depends run install uninstall help parameters version

extracted_opts=

extract_opts()
{
  while [ $# -gt 0 ];
  do
    case "$1" in
      -q|--quiet)
        mt_log_verbose=
        ;;
      -nc|--no-color|--no-colour)
        mt_log_use_color=
        ;;
      *)
        extracted_opts="$extracted_opts$1 "
        ;;
    esac
    shift
  done
}

dispatch ()
{
  module=$1
  shift
  
  case "$module" in
    version|-v|--version)
      mt_version $@
      ;;
    help|-h|--help)
      mt_help $@
      ;;
    install)
      mt_install $@
      ;;
    uninstall)
      mt_uninstall $@
      ;;
    *)
      mt_run $module $@
      ;;
  esac
}

extract_opts $@
dispatch $extracted_opts
